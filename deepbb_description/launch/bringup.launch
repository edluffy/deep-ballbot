<?xml version="1.0" encoding="utf-8"?>
<launch>

  <arg name="use_hardware" default="true"/>
  <arg name="controller_to_spawn" default="Motor1_torque_controller Motor2_torque_controller Motor3_torque_controller" />
  <arg name="rvizconfig" default="$(find deepbb_description)/rviz/urdf.rviz"/>

  <param name="robot_description" command="$(find xacro)/xacro $(find deepbb_description)/urdf/deep_ballbot.xacro" />


  <!-- Load joint controller configurations from YAML file to parameter server -->
  <rosparam command="load" file="$(find deepbb_description)/config/deepbb_controller.yaml" />

  <node name="deepbb_hardware_interface" pkg="deepbb_hardware_interface" type="deepbb_hardware_interface_node"/>

  <!-- Load robot state publisher -->
  <node name="robot_state_publisher" pkg="robot_state_publisher" type="robot_state_publisher">
    <param name="ignore_timestamp" type="bool" value="true"/>
  </node>

  <!-- Load controllers -->
  <node name="controller_spawner" pkg="controller_manager" type="spawner" respawn="false" output="screen"
    args="joint_state_controller $(arg controller_to_spawn)"/>

  <node name="rviz" pkg="rviz" type="rviz" args="-d $(arg rvizconfig)"/>

  <!-- Sim stuff -->
  <group unless="$(arg use_hardware)">
    <param command="$(find xacro)/xacro $(find deepbb_description)/urdf/deep_ballbot.xacro" name="robot_description"/>
    <node args="-param robot_description -urdf -model deep_ballbot" name="spawn_urdf" pkg="gazebo_ros" type="spawn_model"/>
    <include file="$(find gazebo_ros)/launch/empty_world.launch">
      <arg name="paused" value="true"/>
      <arg name="use_sim_time" value="true"/>
      <arg name="gui" value="true"/>
      <arg name="headless" value="false"/>
      <arg name="debug" value="false"/>
    </include>
  </group>

</launch>
